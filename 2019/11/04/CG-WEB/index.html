<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="0x01  签到题打开页面后，查看源代码。
0x02  md5 collision源码给出。

分析源码：

变量a，GET传参，不为空，且不等于QNKCDZO。
变量a的MD5值等于QNKCDZO的MD5值。        

考查知识：PHP弱类型，MD5。
小贴士：在PHP中，@被称为错误控制">


<link rel="alternate" href="/atom.xml" title="Gu Chuan&#39;s blog" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>CG-WEB - Gu Chuan&#39;s blog</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="shortcut icon" href="/favicon.png">
<link rel="stylesheet" href="/css/style.css">
<nav class="main-nav">
	
	    <a href="/">← Home</a>
	
	
	    <a href="/about/">About</a>
	
	    <a href="/archives/">Archives</a>
	
	    <a href="/links/">Links</a>
	
	<a class="cta" href="/atom.xml" data-no-instant>Subscribe</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>CG-WEB</h1>
        
        <h2 class="headline">Nov 04 2019
        
        </h2>
    </header>
</article>
<section id="post-body"><h1 id="0x01-签到题"><a href="#0x01-签到题" class="headerlink" title="0x01  签到题"></a>0x01  签到题</h1><p>打开页面后，查看源代码。</p>
<h1 id="0x02-md5-collision"><a href="#0x02-md5-collision" class="headerlink" title="0x02  md5 collision"></a>0x02  md5 collision</h1><p>源码给出。</p>
<p><img src="/2019/11/04/CG-WEB/md5_collison.png" alt></p>
<p>分析源码：</p>
<ol>
<li>变量a，GET传参，不为空，且不等于QNKCDZO。</li>
<li>变量a的MD5值等于QNKCDZO的MD5值。        </li>
</ol>
<p>考查知识：PHP弱类型，MD5。</p>
<p>小贴士：在PHP中，@被称为错误控制操作符(error control operator)，前置@符号的表达式产生的任何错误都将被忽略。</p>
<p>解题方式：<code>?a= s1502113478a</code></p>
<h1 id="0x03-签到2"><a href="#0x03-签到2" class="headerlink" title="0x03  签到2"></a>0x03  签到2</h1><p>打开题目。</p>
<p><img src="/2019/11/04/CG-WEB/sign_in2.png" alt></p>
<p>输入 zhimakaimen ，无果。</p>
<p>口令错误？F12查看页面信息。</p>
<p><img src="/2019/11/04/CG-WEB/sign_in1.png" alt></p>
<p>口令长度为11，而输入的长度为10。</p>
<p>解题方式：</p>
<ol>
<li>maxlength=”10”* 字段修改为 <em>maxlength=”11”</em> 或是更大的值 ，并输入zhimakaimen。</li>
<li>post传值text1=zhimakaimen。</li>
</ol>
<h1 id="0x04-这题不是WEB"><a href="#0x04-这题不是WEB" class="headerlink" title="0x04  这题不是WEB"></a>0x04  这题不是WEB</h1><p>下载图片，记事本打开。</p>
<p>考查知识：图片隐写。</p>
<h1 id="0x05-层层递进"><a href="#0x05-层层递进" class="headerlink" title="0x05  层层递进"></a>0x05  层层递进</h1><p>此题“白嫖”。</p>
<p>解题方式：F12查看页面信息，跟随链接，依次访问<code>SO.html</code> -&gt; <code>S0.html</code>-&gt;<code>SO.htm</code> -&gt;<code>S0.htm</code>-&gt;<code>404.html</code> ，查看源码。</p>
<p><img src="/2019/11/04/CG-WEB/layer.png" alt></p>
<p>所以，你是几秒看出flag？</p>
<h1 id="0x06-AAencode"><a href="#0x06-AAencode" class="headerlink" title="0x06  AAencode"></a>0x06  AAencode</h1><p>打开题目。</p>
<p><img src="/2019/11/04/CG-WEB/aaencode1.png" alt></p>
<p>虽然看上去像aaencode编码，但是其中包含乱码，所以需要去乱码。</p>
<p>ALT键-&gt;查看-&gt;文字编码-&gt;Unicode </p>
<p><img src="/2019/11/04/CG-WEB/aaencode2.png" alt></p>
<p>题目提示（考查知识）： javascript aaencode 。</p>
<p>解题方式：</p>
<p>​    1.控制台console 直接执行。</p>
<p>​    2.在线aaencode解码网站解码。</p>
<h1 id="0x07-单身二十年"><a href="#0x07-单身二十年" class="headerlink" title="0x07  单身二十年"></a>0x07  单身二十年</h1><p>打开题目，点击“到这里找key”。</p>
<p><img src="/2019/11/04/CG-WEB/single1.png" alt></p>
<p>这里永远没有钥匙~</p>
<p>回最初页面，找线索。</p>
<p><img src="/2019/11/04/CG-WEB/single2.png" alt></p>
<p>仔细观察，URL有所不同。点击！叮！flag！</p>
<p>考查知识：URL重定向。</p>
<h1 id="0x08-php-decode"><a href="#0x08-php-decode" class="headerlink" title="0x08  php decode"></a>0x08  php decode</h1><p>考查知识：PHP函数之eval()</p>
<p>解题方式：eval()-&gt;echo()源码直接执行。</p>
<h1 id="0x09-文件包含"><a href="#0x09-文件包含" class="headerlink" title="0x09  文件包含"></a>0x09  文件包含</h1><p>打开页面，访问链接。</p>
<p><img src="/2019/11/04/CG-WEB/Include.png" alt></p>
<p>小贴上：形如?file=xxx.php，可能有文件包含。</p>
<p>题目提示（考查知识）：文件包含（LFI、RFI），PHP://filter。</p>
<p>解题方式：?file=php://filter/read=convert.base64-encode/resource=index.php，base64解码。</p>
<p><img src="/2019/11/04/CG-WEB/Included.png" alt></p>
<h1 id="0x10-单身一百年也没用"><a href="#0x10-单身一百年也没用" class="headerlink" title="0x10  单身一百年也没用"></a>0x10  单身一百年也没用</h1><p>单身二十年不够？单身一百年？</p>
<p>解题方式：F12查看网络信息，消息头。</p>
<h1 id="0x11-Download"><a href="#0x11-Download" class="headerlink" title="0x11  Download~!"></a>0x11  Download~!</h1><p>此题访问失败，再次“白嫖”。</p>
<p><img src="/2019/11/04/CG-WEB/download.png" alt></p>
<h1 id="0x12-COOKIE"><a href="#0x12-COOKIE" class="headerlink" title="0x12  COOKIE"></a>0x12  COOKIE</h1><p>题目提示（考查知识）：COOKIE，0==not。</p>
<p>解题方式：根据提示，F12查看网络状态中消息头，改0位1。</p>
<p><img src="/2019/11/04/CG-WEB/cookie.png" alt></p>
<h1 id="0x13-MYSQL"><a href="#0x13-MYSQL" class="headerlink" title="0x13  MYSQL"></a>0x13  MYSQL</h1><p>打开题目，robots.txt？了解一下。</p>
<p><img src="/2019/11/04/CG-WEB/mysql.png" alt></p>
<p>ALT键，改一下编码。</p>
<p>分析源码：</p>
<ol>
<li>sql.php中GET传参。变量id，取整数值，且id不等于1024。</li>
<li>mysql数据库连接，查询id等于所传变量的行。</li>
</ol>
<p>考查知识：robots协议，PHP传参方法，PHP函数之intval()，MySQL。</p>
<p>解题方式：?id=1024.111</p>
<p>小贴士：别放过细节，不会无缘无故给1024。</p>
<h1 id="0x14-GBK-InJection"><a href="#0x14-GBK-InJection" class="headerlink" title="0x14   GBK InJection"></a>0x14   GBK InJection</h1><p>此题涨知识，所以还是“白嫖”。</p>
<p>打开题目，可以知道是SQL注入。加个单引号试试，单引号被转义。即单引号自动被转义。</p>
<p><img src="/2019/11/04/CG-WEB/gbk_injection.png" alt></p>
<p>题目提示（考查知识）：宽字节注入(GBK注入)，union查询原则。</p>
<p>解题方式：</p>
<ol>
<li><code>?id=4</code>    //可以知道有2个字段。同理 ?id=1%df’ order by 2 %23，也可知道有2个字段。</li>
<li><code>?id=%df&#39; union select 1,2 --+</code>    //回显位在2的位置。</li>
<li><code>?id=%df&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()--+</code>      //得到表名。  一共有6个表，看你运气好不好了。</li>
<li><code>?id=%df&#39; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x63746634--+</code>      //得到字段名。因为单引号自动转义，所以将表名转为十六进制，进而查询。</li>
<li><code>?id=%df&#39; union select 1,flag from ctf4--+</code>  //得到flag。</li>
</ol>
<h1 id="0x15-x00"><a href="#0x15-x00" class="headerlink" title="0x15  /x00"></a>0x15  /x00</h1><p>打开题目，源码给出。</p>
<p><img src="/2019/11/04/CG-WEB/x00.png" alt></p>
<p>分析源码：变量nctf，GET传值。变量nctf必须是数字，并且变量nctf包含#biubiubiu。</p>
<p>考查知识：PHP函数之ereg()、PHP函数之strpos()。逻辑漏洞。</p>
<p>解题方式：</p>
<ol>
<li><code>?nctf=1%00%23biubiubiu</code>   //ereg()漏洞之%00截断</li>
<li><code>?nctf[]=123</code>     //ereg()、strpos()处理数组，返回null，且null !==false。</li>
</ol>
<h1 id="0x16-bypass-again"><a href="#0x16-bypass-again" class="headerlink" title="0x16  bypass again"></a>0x16  bypass again</h1><p>源码。</p>
<p><img src="/2019/11/04/CG-WEB/by_pass.png" alt></p>
<p>分析源码：</p>
<ol>
<li>变量a、变量b，GET传值。</li>
<li>变量a不等于变量b，但变量a的MD5值等于变量b的MD5值。</li>
</ol>
<p>考查知识：MD5、PHP弱类型。</p>
<p>解题方式：</p>
<ol>
<li><code>?a[]=123&amp;b[]=456</code>  //md5()处理数组，返回null。</li>
<li><code>?a=s878926199a&amp;b=s1091221200a</code>  //PHP弱类型。</li>
</ol>
<h1 id="0x17-变量覆盖"><a href="#0x17-变量覆盖" class="headerlink" title="0x17  变量覆盖"></a>0x17  变量覆盖</h1><p>打开题目，提交页面? source at /source.php ?</p>
<p><img src="/2019/11/04/CG-WEB/extract.png" alt></p>
<p>分析源码：提交的数据是POST方式传来的 ，变量pass和变量thepassword_123的值相等。</p>
<p>考查知识：变量覆盖之extract()、POST传参、PHP之$_SERVER[]获取环境变量。</p>
<p>解题方式：The Ducks页面POST <code>pass=1&amp;thepassword_123=1</code> </p>
<h1 id="0x18-PHP是世界上最好的语言"><a href="#0x18-PHP是世界上最好的语言" class="headerlink" title="0x18  PHP是世界上最好的语言"></a>0x18  PHP是世界上最好的语言</h1><p>打不开呀打不开，贴一下源码。</p>
<p><img src="/2019/11/04/CG-WEB/PHP.png" alt></p>
<p>分析源码：</p>
<ol>
<li>GET方式传来的变量id不等于hackerDJ，并且变量id要经过一次URL解码。</li>
<li>解码后的变量id，等于hackerDJ</li>
</ol>
<p>考查知识： 二次编码。页面传递时，自动进行一次URLdecode 。URL编码。</p>
<p>解题方式：</p>
<ol>
<li><code>?id=%2568%2561%2563%256b%2565%2572%2544%254a</code></li>
<li><code>?id= %2568ackerDJ</code></li>
</ol>
<h1 id="0x19-伪装者"><a href="#0x19-伪装者" class="headerlink" title="0x19  伪装者"></a>0x19  伪装者</h1><p>打开题目。“ 管理系统只能在本地登陆，本系统外部禁止访问， 不是本地登陆你还想要flag？  ”</p>
<p>考查知识：X-Forwarded-For、Client-IP。即获取客户端IP。</p>
<p>解题方式：F12网络状态，请求头加入Client-IP: 127.0.0.1，查看响应。</p>
<h1 id="0x20-Header"><a href="#0x20-Header" class="headerlink" title="0x20  Header"></a>0x20  Header</h1><p> 头啊！！头啊！！！ —————&gt;F12一系列操作。</p>
<h1 id="0x21-上传绕过"><a href="#0x21-上传绕过" class="headerlink" title="0x21  上传绕过"></a>0x21  上传绕过</h1><p><img src="/2019/11/04/CG-WEB/upload1.png" alt></p>
<p>分析源码：”hidden”隐藏dir的value，猜测dir和file相连。”filename”判断jpg，“/uploads/”判断php。</p>
<p>考查知识：文件上传之%00截断。</p>
<p>解题方式：上传一张<code>qqq.jpg</code>图片，抓包后修改<code>/uploads/</code>为<code>/uploads/aaa.php_</code>，然后file保持<code>qqq.jpg</code>，连起来后就是<code>/uploads/aaa.php_qqq.jpg</code>， 然后打开hex编码寻找<code>_</code>及59，将其修改为00，回车确认。 此时变成<code>/uploads/aaa.php qqq.jpg</code>，则既绕过了白名单验证又上传了PHP后缀的文件。（0x00是指修改16进制值，不可见。）</p>
<p><img src="/2019/11/04/CG-WEB/upload2.png" alt></p>
<h1 id="0x22-SQL注入1"><a href="#0x22-SQL注入1" class="headerlink" title="0x22  SQL注入1"></a>0x22  SQL注入1</h1><p>Source，查看源码。</p>
<p><img src="/2019/11/04/CG-WEB/sql1.png" alt></p>
<p>分析源码：</p>
<ol>
<li>POST传入参数user、pass，并且除去参数两端空格。</li>
<li>查询user为admin的数据（记录）。</li>
</ol>
<p>考查知识：MySQL语法，SQL注入之注释，逻辑漏洞。</p>
<p>解题方式：POST <code>user=admin&#39;)#&amp;pass=111</code></p>
<h1 id="0x23-passcheck"><a href="#0x23-passcheck" class="headerlink" title="0x23  passcheck"></a>0x23  passcheck</h1><p>源码。</p>
<p><img src="/2019/11/04/CG-WEB/pass_check.png" alt></p>
<p>分析源码：POST传值的变量pass和已定义的变量pass1的值要相同。</p>
<p>考查知识：PHP函数之strcmp()，PHP弱比较。</p>
<p>解题方式：<code>?pass[]=123</code>   //strcmp()处理数组，返回null。</p>
<h1 id="0x24-起名字真难"><a href="#0x24-起名字真难" class="headerlink" title="0x24  起名字真难"></a>0x24  起名字真难</h1><p>“白嫖”。</p>
<p><img src="/2019/11/04/CG-WEB/name.png" alt></p>
<p>分析源码：GET传入key不可以包含1-9，但是要是54975581388。</p>
<p>考查知识：PHP函数之ord()，细节漏洞。</p>
<p>解题方式： <code>?key=0xccccccccc</code></p>
<h1 id="0x25-密码重置"><a href="#0x25-密码重置" class="headerlink" title="0x25  密码重置"></a>0x25  密码重置</h1><p> 打开题目。URL惊现Base64。</p>
<p><img src="/2019/11/04/CG-WEB/password1.png" alt></p>
<p>题目提示：“ 重置管理员账号：admin 的密码 ”。</p>
<p>考查知识：细节漏洞，逻辑漏洞。</p>
<p>解题方式：</p>
<p><img src="/2019/11/04/CG-WEB/password2.png" alt></p>
<h1 id="0x26-PHP-反序列化"><a href="#0x26-PHP-反序列化" class="headerlink" title="0x26  PHP 反序列化"></a>0x26  PHP 反序列化</h1><p>暂时无法做！但是有源码。</p>
<p><img src="/2019/11/04/CG-WEB/unserialize.png" alt></p>
<p>分析源码：</p>
<ol>
<li><p>一个just4fun类。GET传送的变量pass被反序列化，其是just4fun的一个子类。</p>
</li>
<li><p>类中secret变量和enter变量相等。</p>
</li>
</ol>
<p>题目提示（考查知识）：PHP序列化和反序列化。</p>
<p>解题方式：</p>
<p><img src="/2019/11/04/CG-WEB/unserialized.png" alt></p>
<h1 id="0x27-SQL-InJection"><a href="#0x27-SQL-InJection" class="headerlink" title="0x27  SQL InJection"></a>0x27  SQL InJection</h1></section>
    
        
        <h2 class="footline">
            <a href="/tags/ctf/#ctf">ctf</a>
        </h2>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/guchuan.JPG">
        <div>
            <span class="dark">Gu Chuan&#39;s blog</span>
            <span>没学过从来不是理由</span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2019/11/04/CG-WEB/ - CG-WEB @" target="_blank" rel="noopener"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">Load Comments</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "CG-WEB",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
	<div id="social">
		<p class="small">©  Gu Chuan&#39;s blog| Powered by Hexo & 
			<a href="https://github.com/F0r3at/Lights" target="_blank" rel="noopener"> Lights</a>
		</p>
	</div>
</footer>

</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



