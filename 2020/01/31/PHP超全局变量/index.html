<!DOCTYPE html>

<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">

  <meta name="description" content="超全局变量全局变量是在当前页面全部地方有效的变量。
超全局变量是在整个网站全部地方有效，在全部作用域中始终可用的内置变量。
$GLOBALS 引用全局作用域中可用的全部变量。它是一个包含全局变量的全部组合数组，而变量的名字就是数组的键。
1234$var = value;echo $GLOBALS[">


<link rel="alternate" href="/atom.xml" title="Gu Chuan&#39;s blog" type="application/atom+xml">
<meta name="theme-color" content="#a1d0f6">
<title>PHP超级全局变量 - Gu Chuan&#39;s blog</title>
<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<link rel="shortcut icon" href="/favicon.png">
<link rel="stylesheet" href="/css/style.css">
<nav class="main-nav">
	
	    <a href="/">← Home</a>
	
	
	    <a href="/about/">About</a>
	
	    <a href="/archives/">Archives</a>
	
	    <a href="/links/">Links</a>
	
	<a class="cta" href="/atom.xml" data-no-instant>Subscribe</a>
</nav>

<section id="wrapper">
    <article class="post">
    <header>
        
            <h1>PHP超级全局变量</h1>
        
        <h2 class="headline">Jan 31 2020
        
        </h2>
    </header>
</article>
<section id="post-body"><h1 id="超全局变量"><a href="#超全局变量" class="headerlink" title="超全局变量"></a>超全局变量</h1><p>全局变量是在当前页面全部地方有效的变量。</p>
<p>超全局变量是在整个网站全部地方有效，在全部作用域中始终可用的内置变量。</p>
<p><a href="https://www.php.net/manual/zh/reserved.variables.globals.php" target="_blank" rel="noopener">$GLOBALS</a> 引用全局作用域中可用的全部变量。它是一个包含全局变量的全部组合数组，而变量的名字就是数组的键。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$var = value;</span><br><span class="line">echo $GLOBALS[&apos;var&apos;];//输出变量值。</span><br><span class="line"></span><br><span class="line">print_r($GLOBALS);//输出全局作用域内中所有变量。</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.server.php" target="_blank" rel="noopener">$_SERVER</a> 服务器和执行环境信息。它是一个包含头信息、路径、脚本位置等信息的数组。数组中的项目由 Web 服务器创建。 根据服务器不同，$_SERVER中的变量值和变量个数会有差别。</p>
<table>
<thead>
<tr>
<th>数组元素</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>$_SERVER[‘PHP_SELF’]</td>
<td>当前执行脚本的文件名，与 document root 有关。例如，在地址为  <a href="http://example.com/test.php/foo.bar" target="_blank" rel="noopener">http://example.com/test.php/foo.bar</a> 的脚本中使用 $<em>SERVER[‘PHP_SELF’] 将得到  /test.php/foo.bar。_</em> FILE __ 常量包含当前文件的完整路径和文件名。 从 PHP 4.3.0 版本开始，如果  PHP 以命令行模式运行，这个变量将包含脚本名。之前的版本该变量不可用。</td>
</tr>
<tr>
<td>$_SERVER[‘GATEWAY_INTERFACE’]</td>
<td>服务器使用的 CGI 规范版本。(CGI公共网关接口，Web 服务器运行时外部程序的规范)的例如，”CGI/1.1”。</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_ADDR’]</td>
<td>当前运行脚本所在的服务器的 IP 地址。</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_NAME’]</td>
<td>当前运行脚本所在的服务器的主机名。如果脚本运行于虚拟主机中，该名称是由那个虚拟主机所设置的值决定。(如: <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a>)</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_SOFTWARE’]</td>
<td>服务器标识字符串，在响应请求时的头信息中给出。 (如：Apache/2.2.24)</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_PROTOCOL’]</td>
<td>请求页面时通信协议的名称和版本。例如，”HTTP/1.0”。</td>
</tr>
<tr>
<td>$_SERVER[‘REQUEST_METHOD’]</td>
<td>访问页面使用的请求方法；例如，”GET”, “HEAD”，”POST”，”PUT”。</td>
</tr>
<tr>
<td>$_SERVER[‘REQUEST_TIME’]</td>
<td>请求开始时的时间戳。从 PHP 5.1.0 起可用。 (如：1377687496)</td>
</tr>
<tr>
<td>$_SERVER[‘QUERY_STRING’]</td>
<td>query string（查询字符串），如果有的话，通过它进行页面访问。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_ACCEPT’]</td>
<td>当前请求头中 Accept: 项的内容，如果存在的话。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_ACCEPT_CHARSET’]</td>
<td>当前请求头中 Accept-Charset: 项的内容，如果存在的话。例如：”iso-8859-1,*,utf-8”。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_ACCEPT_ENCODING’]</td>
<td>当前请求头中 <em>Accept-Encoding:</em> 项的内容，如果存在的话。例如：“<em>gzip</em>”。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_ACCEPT_LANGUAGE’]</td>
<td>当前请求头中 <em>Accept-Language:</em> 项的内容，如果存在的话。例如：“<em>en</em>”。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_CONNECTION’]</td>
<td>当前请求头中 <em>Connection:</em> 项的内容，如果存在的话。例如：“<em>Keep-Alive</em>”。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_HOST’]</td>
<td>当前请求头中 Host: 项的内容。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_REFERER’]</td>
<td>引导用户代理到当前页的前一页的地址（如果存在）。由 user agent 设置决定。并不是所有的用户代理都会设置该项，有的还提供了修改 HTTP_REFERER 的功能。简言之，该值并不可信。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTP_USER_AGENT’]</td>
<td>当前请求头中 <em>User-Agent:</em> 项的内容，如果存在的话。该字符串表明了访问该页面的用户代理的信息。一个典型的例子是：Mozilla/4.5 [en] (X11; U;       Linux 2.2.9 i586)。除此之外，你可以通过 <a href="https://www.php.net/manual/zh/function.get-browser.php" target="_blank" rel="noopener">get_browser()</a> 来使用该值，从而定制页面输出以便适应用户代理的性能。</td>
</tr>
<tr>
<td>$_SERVER[‘HTTPS’]</td>
<td>如果脚本是通过 HTTPS 协议被访问，则被设为一个非空的值。</td>
</tr>
<tr>
<td>$_SERVER[‘REMOTE_ADDR’]</td>
<td>浏览当前页面的用户的 IP 地址。</td>
</tr>
<tr>
<td>$_SERVER[‘REMOTE_HOST’]</td>
<td>浏览当前页面的用户的主机名。DNS 反向解析不依赖于用户的 REMOTE_ADDR。</td>
</tr>
<tr>
<td>$_SERVER[‘REMOTE_PORT’]</td>
<td>用户机器上连接到 Web 服务器所使用的端口号。</td>
</tr>
<tr>
<td>$_SERVER[‘REMOTE_USER’]</td>
<td>经验证的用户。</td>
</tr>
<tr>
<td>$_SERVER[‘REDIRECT_REMOTE_USER’]</td>
<td>验证的用户，如果请求已在内部重定向。</td>
</tr>
<tr>
<td>$_SERVER[‘SCRIPT_FILENAME’]</td>
<td>当前执行脚本的绝对路径。</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_ADMIN’]</td>
<td>该值指明了 Apache 服务器配置文件中的 SERVER_ADMIN 参数。如果脚本运行在一个虚拟主机上，则该值是那个虚拟主机的值。(如：<a href="mailto:someone@runoob.com" target="_blank" rel="noopener">someone@runoob.com</a>)</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_PORT’]</td>
<td>Web 服务器使用的端口。默认值为 “80”。如果使用 SSL 安全连接，则这个值为用户设置的 HTTP 端口。</td>
</tr>
<tr>
<td>$_SERVER[‘SERVER_SIGNATURE’]</td>
<td>包含了服务器版本和虚拟主机名的字符串。</td>
</tr>
<tr>
<td>$_SERVER[‘PATH_TRANSLATED’]</td>
<td>当前脚本所在文件系统（非文档根目录）的基本路径。这是在服务器进行虚拟到真实路径的映像后的结果。</td>
</tr>
<tr>
<td>$_SERVER[‘SCRIPT_NAME’]</td>
<td>包含当前脚本的路径。这在页面需要指向自己时非常有用。<strong>FILE</strong> 常量包含当前脚本(例如包含文件)的完整路径和文件名。</td>
</tr>
<tr>
<td>$_SERVER[‘SCRIPT_URI’]</td>
<td>URI 用来指定要访问的页面。例如 “/index.html”。</td>
</tr>
<tr>
<td>$_SERVER[‘PHP_AUTH_DIGEST’]</td>
<td>当作为 Apache 模块运行时，进行 HTTP Digest 认证的过程中，此变量被设置成客户端发送的“Authorization” HTTP 头内容（以便作进一步的认证操作）。</td>
</tr>
<tr>
<td>$_SERVER[‘PHP_AUTH_USER’]</td>
<td>当 PHP 运行在 Apache 或 IIS（PHP 5 是 ISAPI）模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的用户名。</td>
</tr>
<tr>
<td>$_SERVER[‘PHP_AUTH_PW’]</td>
<td>当 PHP 运行在 Apache 或 IIS（PHP 5 是 ISAPI）模块方式下，并且正在使用 HTTP 认证功能，这个变量便是用户输入的密码。</td>
</tr>
<tr>
<td>$_SERVER[‘AUTH_TYPE’]</td>
<td>当 PHP 运行在 Apache 模块方式下，并且正在使用 HTTP 认证功能，这个变量便是认证的类型。</td>
</tr>
<tr>
<td>$_SERVER[‘PATH_INFO’]</td>
<td>包含由客户端提供的、跟在真实脚本名称之后并且在查询语句（query string）之前的路径信息，如果存在的话。例如，如果当前脚本是通过 URL <a href="http://www.example.com/php/path_info.php/some/stuff?foo=bar" target="_blank" rel="noopener">http://www.example.com/php/path_info.php/some/stuff?foo=bar</a> 被访问，那么 $_SERVER[‘PATH_INFO’] 将包含 <em>/some/stuff</em>。</td>
</tr>
<tr>
<td>$_SERVER[‘ORIG_PATH_INFO’]</td>
<td>在被 PHP 处理之前，“PATH_INFO” 的原始版本。</td>
</tr>
</tbody></table>
<p><a href="https://www.php.net/manual/zh/reserved.variables.get.php" target="_blank" rel="noopener">$_GET</a>  GET传送方式。它是一个通过 GET方法传递 URL参数给当前脚本的变量的数组。</p>
<p>GET方法是通过 <a href="https://www.php.net/manual/zh/function.urldecode.php" target="_blank" rel="noopener">urldecode()</a> 传递的，即 解码给出的已编码字符串中的任何 %##，加号(+)被解码成一个空格字符。      </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">URL:https://www.guchuan.com/test.php?name=guchuan</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo $_GET[&apos;name&apos;];//输出guchuan</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.post.php" target="_blank" rel="noopener">$_POST</a> POST传送方式。它是一个通过 POST方法传递表单参数或上传文件参数给当前脚本的变量的数组。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;];?&gt;&quot;&gt;</span><br><span class="line">Name:&lt;input type=&quot;text&quot; name=&quot;fname&quot;&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"> </span><br><span class="line">&lt;?php</span><br><span class="line">$name = $_POST[&apos;fname&apos;];</span><br><span class="line">echo $name;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.files.php" target="_blank" rel="noopener">$_FILES</a> 上传文件。它是一个包含通过POST方法向服务器上传的数据的有关信息的二维数组，5个元素 。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$_FILES[ &apos;upload-name&apos; ][ &apos;name&apos; ]; 客户端向服务器上传文件的文件名。</span><br><span class="line">$_FILES[ &apos;upload-name&apos; ][ &apos;type&apos; ]; 上传文件的MIME类型，需要浏览器提供该信息的支持，例如“image/gif”。</span><br><span class="line">$_FILES[ &apos;upload-name&apos; ][ &apos;size&apos; ]; 上传文件的大小，以字节为单位。</span><br><span class="line">$_FILES[ &apos;upload-name&apos; ][ &apos;tmp_name&apos; ]; 文件被上传后在服务端储存的临时文件名。</span><br><span class="line">$_FILES[ &apos;upload-name&apos; ][ &apos;error&apos; ];该文件上传相关的错误代码。尽管这个变量的名为 error ，但实际上在成功的情况下也会填写这个变量(PHP 4.2.0)。它有五个可能的值：</span><br><span class="line">	UPLOAD_ERR_OK  文件成功上传。</span><br><span class="line">	UPLOAD_ERR_INI_SIZE 文件大小超出了 upload_max_filesize 指令所指定的最大值。</span><br><span class="line">	UPLOAD_ERR_FORM_SIZE 文件大小超出了MAX_FILE_SIZE 隐藏表单域参数（可选）指定的最大值。</span><br><span class="line">	UPLOAD_ERR_PARTIAL 文件只上传了一部分。</span><br><span class="line">	UPLOAD_ERR_NO_FILE 上传表单中没有指定文件。</span><br><span class="line">	</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;form action=&quot;upload.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;file&quot; name=&quot;filename&quot; id=&quot;file&quot; /&gt; </span><br><span class="line">        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">echo $_FILES[&quot;filename&quot;][&quot;name&quot;];</span><br><span class="line">echo $_FILES[&quot;filename&quot;][&quot;type&quot;];</span><br><span class="line">echo $_FILES[&quot;filename&quot;][&quot;size&quot;];</span><br><span class="line">echo $_FILES[&quot;filename&quot;][&quot;tmp_name&quot;];</span><br><span class="line">echo $_FILES[&quot;filename&quot;][&quot;error&quot;];</span><br><span class="line">?&gt;</span><br><span class="line">注：move_uploaded_file ( string $filename , string $destination )将上传的文件移动到新位置。</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.cookies.php" target="_blank" rel="noopener">$_COOKIE</a> 识别用户信息。 它是一个cookie信息的数组。cookie 是服务器留在用户计算机中的小文件。每当相同的计算机通过浏览器请求页面时， 和HTTP header一起发送给客户端。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">setcookie(&quot;TestCookie&quot;, $value);</span><br><span class="line">setcookie(&quot;TestCookie&quot;, $value, time()+3600); //1 小时过期 </span><br><span class="line">setcookie(&quot;TestCookie&quot;, $value, time()+3600, &quot;/~rasmus/&quot;, &quot;example.com&quot;, 1);</span><br><span class="line"></span><br><span class="line">echo $_COOKIE[&quot;TestCookie&quot;];</span><br><span class="line">print_r($_COOKIE);</span><br><span class="line">setcookie(&quot;user&quot;, &quot;&quot;, time()-3600);//删除cookie</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">注：setcookie(string $name[,string $value=&quot;&quot;[,int $expire=0[,string $path=&quot;&quot;[,string $domain=&quot;&quot;[,bool $secure=false [,bool $httponly=false]]]]]]) 定义cookie</span><br><span class="line">   $_COOKIE[&quot;varname&quot;] 使用cookie变量</span><br><span class="line">   setcookie() 函数必须位于 &lt;html&gt; 标签之前。</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.session.php" target="_blank" rel="noopener">$_SESSION</a> 存储有关用户会话的信息。它是一个保存单一用户信息数组，可供应用程序中的所有页面使用。  Session 的工作机制是：为每个访问者创建一个唯一的 id (UID)，并基于这个 UID 来存储变量。UID 存储在 cookie 中，亦或通过 URL 进行传导。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// page1.php</span><br><span class="line">session_start();</span><br><span class="line">$_SESSION[&apos;favcolor&apos;] = &apos;green&apos;;</span><br><span class="line">$_SESSION[&apos;animal&apos;]   = &apos;cat&apos;;</span><br><span class="line">$_SESSION[&apos;time&apos;]     = time();</span><br><span class="line">echo &apos;&lt;br /&gt;&lt;a href=&quot;page2.php&quot;&gt;page 2&lt;/a&gt;&apos;;使用cookie方式传送会话ID。</span><br><span class="line">echo &apos;&lt;br /&gt;&lt;a href=&quot;page2.php?&apos; . SID . &apos;&quot;&gt;page 2&lt;/a&gt;&apos;;// 使用URL改写的方式传送会话ID。</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">// page2.php</span><br><span class="line">session_start();</span><br><span class="line">echo $_SESSION[&apos;favcolor&apos;]; // green</span><br><span class="line">echo $_SESSION[&apos;animal&apos;];   // cat</span><br><span class="line">echo date(&apos;Y m d H:i:s&apos;, $_SESSION[&apos;time&apos;]);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">注：session_start() 启动新会话或者重用现有会话，session_start() 函数必须位于 &lt;html&gt; 标签之前。</span><br><span class="line">   $_SESSION[&apos;varname&apos;] 设置和使用session变量</span><br><span class="line">   unset() 释放session变量</span><br><span class="line">   session_destroy() 终结session变量</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.request.php" target="_blank" rel="noopener">$_REQUEST</a> 收集HTML表单提交的数据。它是一个包含了$_GET、$ _POST、$ _COOKIE等方法传递表单所有信息的数组，其中变量顺序依赖 variables_order 配置指令所指定的顺序，而不依赖在发送脚本中出现的顺序 。 由于 $ _REQUEST 中的变量通过 GET，POST 和 COOKIE 输入机制传递给脚本文件，因此可以被远程用户篡改而并不可信。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form method=&quot;post&quot; action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;];?&gt;&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;fname&quot;&gt;</span><br><span class="line">&lt;input type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;?php </span><br><span class="line">$name = $_REQUEST[&apos;fname&apos;]; </span><br><span class="line">echo $name; </span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">注：import_request_variables(string $types [,string $prefix])将GET／POST／Cookie变量导入到全局作用域中。</span><br><span class="line">types 参数指定需要导入的变量。可以用字母‘G’、‘P’和‘C’分别表示 GET、POST 和 Cookie。这些字母不区分大小写，所以你可以使用‘g’、‘p’和‘c’的任何组合。POST 包含了通过 POST 方法上传的文件信息。注意这些字母的顺序，当使用“gp”时，POST 变量将使用相同的名字覆盖 GET 变量。任何 GPC 以外的字母都将被忽略。</span><br><span class="line">prefix 参数作为变量名的前缀，置于所有被导入到全局作用域的变量之前。所以如果你有个名为“userid”的 GET 变量，同时提供了“pref_”作为前缀，那么你将获得一个名为 $pref_userid 的全局变量。</span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/reserved.variables.environment.php" target="_blank" rel="noopener">$_ENV</a> 服务器端环境变量。它是一个通过环境方式( 从PHP解析器的运行环境导入到 PHP的全局命名空间 )传递给当前脚本变量的数组。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$_ENV[&apos;HOSTNAME&apos;] 服务器的主机名</span><br><span class="line">$_ENV[&apos;SHELL&apos;]    系统 shell</span><br><span class="line">$_ENV[&apos;USER&apos;]     用户名</span><br><span class="line">...</span><br><span class="line">print_r($_ENV);   输出所有环境变量</span><br><span class="line">注：getenv() 获取一个环境变量的值。使用phpinfo()可以看到所有环境变量的列表。</span><br></pre></td></tr></table></figure>





<h1 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">变量覆盖漏洞</span><br><span class="line">if (isset($_REQUEST[&apos;GLOBALS&apos;]) OR isset($_FILES[&apos;GLOBALS&apos;])) &#123;</span><br><span class="line"> exit(&apos;Request tainting attempted.&apos;);</span><br><span class="line">&#125;//如果提交的数据中有GLOBALS变量名, 就终止程序。</span><br><span class="line"></span><br><span class="line">register_globals 是php中的一个控制选项，可以设置成off或者on。</span><br><span class="line">默认为off,决定是否将 EGPCS(Environment，GET，POST，Cookie，Server)变量注册为全局变量。</span><br><span class="line">如果 register_globals=on, 客户端提交的数据中含有GLOBALS变量名, 就会覆盖服务器上的$GLOBALS变量。$_REQUEST超全局变量的值受php.ini中request_order的影响。在最新的php5.3.x系列中，request_order默认值为GP，也就是说默认配置下$_REQUEST只包含$_GET和$_POST而不包括$_COOKIE。通过 COOKIE就可以提交GLOBALS变量。</span><br><span class="line"></span><br><span class="line">import_request_variables -- 将 GET／POST／Cookie 变量导入到全局作用域中。</span><br><span class="line">extract --  从数组中将变量导入到当前的符号表。</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">session 劫持漏洞</span><br><span class="line">session 劫持是指攻击者利用各种手段来获取目标用户的session id。一旦获取到session id，那么攻击者可以利用目标用户的身份来登录网站，获取目标用户的操作权限。</span><br><span class="line">攻击者获取目标用户session id的方法:</span><br><span class="line">1）暴力破解:尝试各种session id，直到破解为止。</span><br><span class="line">2）计算:如果session id使用非随机的方式产生，那么就有可能计算出来。</span><br><span class="line">3）窃取:使用网络截获，xss攻击等方法获得。(主要)</span><br><span class="line">防范方法：</span><br><span class="line">1）定期更改session id。</span><br><span class="line">session_regenerate_id([bool delete_old_session])</span><br><span class="line">delete_old_session为true，则删除旧的session文件；为false，则保留旧的session，默认false，可选。</span><br><span class="line">2）更改session的名称</span><br><span class="line">session的默认名称是PHPSESSID,此变量会保存在cookie中，如果黑客不抓包分析，就不能猜到这个名称，阻挡部分攻击。</span><br><span class="line">3）关闭透明化session id</span><br><span class="line">透明化session id指当浏览器中的http请求没有使用cookies来制定session id时，sessioin id使用链接来传递；打开php.ini，编辑session.use_trans_sid = 0</span><br><span class="line">4）只从cookie检查session id</span><br><span class="line">session.use_cookies = 1 表示使用cookies存放session id。</span><br><span class="line">session.use_only_cookies = 1 表示只使用cookies存放session id，这可以避免session固定攻击代码中。</span><br><span class="line">5）使用URL传递隐藏参数</span><br><span class="line">session_start();</span><br><span class="line">$seid = md5(uniqid(rand()), TRUE));</span><br><span class="line">$_SESSION[&quot;seid&quot;] = $seid;</span><br><span class="line">攻击者虽然能获取session数据，但是无法得知$seid的值，只要检查seid的值，就可以确认当前页面是否是web程序自己调用的。</span><br><span class="line">6）设置HttpOnly，User-Agent验证，Token校验等</span><br></pre></td></tr></table></figure>







<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://www.cnblogs.com/defunique/articles/2934724.html" target="_blank" rel="noopener">全局变量漏洞</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1529281" target="_blank" rel="noopener">Session 劫持</a></p>
<p><a href="https://www.runoob.com/w3cnote/php-session-login.html" target="_blank" rel="noopener">PHP 会话实现登录功能</a></p>
</section>
    
        
        <h2 class="footline">
            <a href="/tags/knowledge/#knowledge">knowledge</a>
        </h2>
    

    <footer id="post-meta" class="clearfix">
        <a href="/about/">
        <img class="avatar" src="/images/guchuan.JPG">
        <div>
            <span class="dark">Gu Chuan&#39;s blog</span>
            <span>没学过从来不是理由</span>
        </div>
        </a>
        <section id="sharing">
            <a title="Share to Twitter" class="twitter" href="https://twitter.com/intent/tweet?text=http://yoursite.com/2020/01/31/PHP%E8%B6%85%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F/ - PHP超级全局变量 @" target="_blank" rel="noopener"><span class="icon-twitter">tweet</span></a>
            <a title="Share to Facebook" class="facebook" href="#" onclick="
                window.open(
                  'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
                  'facebook-share-dialog',
                  'width=626,height=436');
                return false;"><span class="icon-facebook-sign">Share</span>
            </a>
        </section>
    </footer>


  <section id="comment">
    <button class="btn" id="loadcmts" onclick="cmts.load();">Load Comments</button>
    <div id="gitment"></div>
    <script src='/js/gitment.browser.js'></script>
    <link rel="stylesheet" href=''>
    <script>
      var cmts={
        load:function cmts(){
          var gitment = new Gitment({
          
            id: "PHP超级全局变量",
          
            owner: "",
            repo: "",
            oauth: {
              client_id: "",
              client_secret: "",
            },
          })
          gitment.render('gitment');
          var loadcmt = document.getElementById("loadcmts");
          var imyourfather = loadcmt.parentNode;
          imyourfather.removeChild(loadcmts)
        }
      }
    </script>
  </section>


	<footer id="footer">
	<div id="social">
		<p class="small">©  Gu Chuan&#39;s blog| Powered by Hexo & 
			<a href="https://github.com/F0r3at/Lights" target="_blank" rel="noopener"> Lights</a>
		</p>
	</div>
</footer>

</section>

	<script src="//cdnjs.loli.net/ajax/libs/instantclick/3.0.1/instantclick.min.js" data-no-instant></script>
	<script data-no-instant>
		
		InstantClick.init('mousedown');
	</script>



